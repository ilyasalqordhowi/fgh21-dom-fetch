<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tugas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="form-identitas">
        <span class="blur">
            <form id="identitas">
        <div class="all-box">
    <h1>Rokok Enak</h1>
    <div class="font1">
        <label for="name">Siapa nama anda?</label>
    </div>
    <input type="text" id="name" name="name">
    <div>
        <label for="umur">berapa umur anda?</label>
    </div>
    <input type="number" id="umur" name="umur">
    <div>
        <div>Apa jenis kelamin anda?</div>
        <input type="radio" id="laki-laki" name="kelamin" value="laki-laki">
        <label for="laki-laki">laki-laki</label>
        
        <input type="radio" id="perempuan" name="kelamin" value="perempuan">
        <label for="perempuan">perempuan</label>
    </div>
    <div>
        <div>Apakah anda perokok?</div>
        <input type="radio" id="Yes" name="perokok" value="Ya">
        <label for="Yes">Ya</label>
         
        <input type="radio" id="No" name="perokok" value="Tidak">
        <label for="No">Tidak</label>
        
    </div>
    <div>
        <div>Jika anda perokok,rokok apa yang anda pernah coba?</div>
        <div>
            <input type="checkbox" id="Gudang" value="Gudang Garam Filter" name="typeRokok">
            <label for="Gudang">Gudang Garam Filter</label>
        </div>
        <div>
            <input type="checkbox" id="Lucky" value="Lucky Strike" name="typeRokok">
            <label for="Lucky">Lucky Strike</label>
        </div>
        <div>
            <input type="checkbox" id="Marlboro" value="Marlboro" name="typeRokok">
            <label for="Marlboro">Marlboro</label>
        </div>
        <div>
            <input type="checkbox" id="Esse" value="Esse" name="typeRokok" >
            <label for="Esse">Esse</label>
        </div>
    </div>
    <button id="save" type="submit">save</button>

    <table    border="1" style="border-collapse: collapse; margin-top: 30px;">
        <thead>
            <tr>
                <th>Name</th>
                <th>Age</th>
                <th>Gender</th>
                <th>Is respondent smoker?</th>
                <th>Cigar variant that respondent have try</th>
            </tr>
        </thead>
        <tbody id="list-identitas">
            <tr>
                <td>Admin</td>
                <td>28</td>
                <td>Laki-laki</td>
                <td>Ya</td>
                <td>Gudang Garam Filter;Marlboro</td>
            </tr>
        </tbody>
    </table>
        </div>
</form>
</div>
</span>
</div>
<script>
    const form = document.getElementById("identitas");

    const table = document.getElementById("list-identitas");

    form.addEventListener("submit", (event)=>{
        event.preventDefault()
        const name = event.target.name.value;
        const Age = event.target.umur.value
        const Gender = event.target.kelamin.value
        const smokers = event.target.perokok.value
        console.log(name)
        console.log(Age)
        console.log(Gender)
        console.log(smokers)
        const cigarette = document.querySelectorAll('input[type="checkbox"]:checked')
                
            let cigarettes = '';
            for (let i = 0; i < cigarette.length; i++) {
                cigarettes += cigarette[i].value;
                if (i < cigarette.length - 1) {
                    cigarettes += ', ';  
                }
            }console.log(cigarettes)
        const formData = new URLSearchParams();
        formData.append("name", name)
        formData.append("age", Age)
        formData.append("gender", Gender)
        formData.append("isSmoker", smokers)
        formData.append("cigarVariant", cigarettes)


    fetch("https://st2lww-8888.csb.app/ilyas/data", {
    method: "POST",
    body: formData,

  }).then((response) => {
    response.json()
    .then((data) => {
        if (data.succes === true) {
            window.alert(data.message);
        }else{
            window.alert(data.message);
        }
    })
  });
});
const endPoint = "https://st2lww-8888.csb.app/ilyas/data";

async function restAPI(){
    const tr = document.createElement("tr");
    const tdAll = document.createElement("td");
  const api = await fetch(endPoint);
  const data = await api.json();
  for (let i = 0; i < data.length; i ++){
    const result = 'name : '+(data[i].name)
  }
}
tr.appendChild(tdAll)
table.appendChild(result)
restAPI();
   
</script>
</body>
</html>
